{"ast":null,"code":"var _jsxFileName = \"/home/teraoka/app/note/components/writer.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useRef } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport { cacheData, getCache } from '../cache/cache';\nimport { center } from '../styles/styles';\nimport { playCloseSound, playEnterSound } from '../util/sounds';\nimport { setHomeMode } from '../states/appMode';\nimport { height, width } from '../states/windowSize';\nvar Mode;\n\n(function (Mode) {\n  Mode[Mode[\"IN\"] = 0] = \"IN\";\n  Mode[Mode[\"OUT\"] = 1] = \"OUT\";\n})(Mode || (Mode = {}));\n\nexport const Writer = () => {\n  // states\n  const {\n    0: src,\n    1: setSrc\n  } = useState(getCache('writing') || '# Markdown Editor\\n\\nwrite a note here');\n  const {\n    0: mode,\n    1: setMode\n  } = useState(Mode.IN); // reference to child components\n\n  const inputElement = useRef(null);\n  const outputElement = useRef(null); // after mount\n  // - auto resize window\n  // useEffect(() => {\n  //   const adaptWindowSize = () => {\n  //     setHeight((window.innerHeight * 0.9) / 2.1)\n  //     setWidth(window.innerWidth * 0.9 - 20)\n  //   }\n  //   adaptWindowSize()\n  //   window.addEventListener('resize', adaptWindowSize)\n  // }, [])\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37,\n      columnNumber: 5\n    }\n  }, __jsx(\"textarea\", {\n    style: {\n      height: `${height}px`,\n      width: `${width}px`\n    },\n    onChange: e => {\n      setSrc(e.target.value);\n      cacheData('writing', src);\n    },\n    onMouseEnter: () => setMode(Mode.IN),\n    onTouchStart: () => setMode(Mode.IN),\n    onScroll: e => {\n      if (mode == Mode.IN) {\n        outputElement.current.scrollTop = e.currentTarget.scrollTop / (e.currentTarget.scrollHeight - height) * (outputElement.current.scrollHeight - height);\n      }\n    },\n    ref: inputElement,\n    value: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    style: center,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, __jsx(\"button\", {\n    onClick: () => {\n      playEnterSound();\n      fetch('/api/note', {\n        method: 'post',\n        body: JSON.stringify({\n          text: src\n        })\n      });\n      setHomeMode();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 9\n    }\n  }, \"Save\"), __jsx(\"button\", {\n    onClick: () => {\n      playCloseSound();\n      setHomeMode();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 9\n    }\n  }, \"Back\")), __jsx(\"div\", {\n    style: {\n      height: `${height}px`,\n      width: `${width}px`,\n      overflow: 'auto'\n    },\n    onMouseEnter: () => setMode(Mode.OUT),\n    onTouchStart: () => setMode(Mode.OUT),\n    onScroll: e => {\n      if (mode == Mode.OUT) {\n        inputElement.current.scrollTop = e.currentTarget.scrollTop / (e.currentTarget.scrollHeight - height) * (inputElement.current.scrollHeight - height);\n      }\n    },\n    ref: outputElement,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }, __jsx(ReactMarkdown, {\n    source: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 9\n    }\n  })));\n};","map":{"version":3,"sources":["/home/teraoka/app/note/components/writer.tsx"],"names":["useState","useRef","ReactMarkdown","cacheData","getCache","center","playCloseSound","playEnterSound","setHomeMode","height","width","Mode","Writer","src","setSrc","mode","setMode","IN","inputElement","outputElement","e","target","value","current","scrollTop","currentTarget","scrollHeight","fetch","method","body","JSON","stringify","text","overflow","OUT"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport ReactMarkdown from 'react-markdown'\nimport { cacheData, getCache } from '../cache/cache'\nimport { center } from '../styles/styles'\nimport { playCloseSound, playEnterSound } from '../util/sounds'\nimport { setHomeMode } from '../states/appMode'\nimport { height, width } from '../states/windowSize'\n\nenum Mode {\n  IN,\n  OUT,\n}\n\nexport const Writer = () => {\n  // states\n  const [src, setSrc] = useState(\n    getCache('writing') || '# Markdown Editor\\n\\nwrite a note here'\n  )\n  const [mode, setMode] = useState(Mode.IN)\n\n  // reference to child components\n  const inputElement = useRef(null)\n  const outputElement = useRef(null)\n\n  // after mount\n  // - auto resize window\n  // useEffect(() => {\n  //   const adaptWindowSize = () => {\n  //     setHeight((window.innerHeight * 0.9) / 2.1)\n  //     setWidth(window.innerWidth * 0.9 - 20)\n  //   }\n  //   adaptWindowSize()\n  //   window.addEventListener('resize', adaptWindowSize)\n  // }, [])\n\n  return (\n    <div>\n      <textarea\n        style={{ height: `${height}px`, width: `${width}px` }}\n        onChange={(e) => {\n          setSrc(e.target.value)\n          cacheData('writing', src)\n        }}\n        onMouseEnter={() => setMode(Mode.IN)}\n        onTouchStart={() => setMode(Mode.IN)}\n        onScroll={(e) => {\n          if (mode == Mode.IN) {\n            outputElement.current.scrollTop =\n              (e.currentTarget.scrollTop /\n                (e.currentTarget.scrollHeight - height)) *\n              (outputElement.current.scrollHeight - height)\n          }\n        }}\n        ref={inputElement}\n        value={src}\n      ></textarea>\n      <div style={center}>\n        <button\n          onClick={() => {\n            playEnterSound()\n            fetch('/api/note', {\n              method: 'post',\n              body: JSON.stringify({ text: src }),\n            })\n            setHomeMode()\n          }}\n        >\n          Save\n        </button>\n        <button\n          onClick={() => {\n            playCloseSound()\n            setHomeMode()\n          }}\n        >\n          Back\n        </button>\n      </div>\n      <div\n        style={{\n          height: `${height}px`,\n          width: `${width}px`,\n          overflow: 'auto',\n        }}\n        onMouseEnter={() => setMode(Mode.OUT)}\n        onTouchStart={() => setMode(Mode.OUT)}\n        onScroll={(e) => {\n          if (mode == Mode.OUT) {\n            inputElement.current.scrollTop =\n              (e.currentTarget.scrollTop /\n                (e.currentTarget.scrollHeight - height)) *\n              (inputElement.current.scrollHeight - height)\n          }\n        }}\n        ref={outputElement}\n      >\n        <ReactMarkdown source={src}></ReactMarkdown>\n      </div>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}