{"ast":null,"code":"var _jsxFileName = \"/home/teraoka/app/note/components/writer.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useState, useRef } from 'react';\nimport ReactMarkdown from 'react-markdown';\nimport { cacheData, getCache } from '../cache/cache';\nimport { buttons, leftPane, rightPane } from '../styles/styles';\nimport { windowHeight } from '../states/windowSize';\nimport { BackButton } from './backButton';\nimport { SaveButton, saveNote } from './saveButton';\nimport { isWriteMode } from '../states/appMode';\nimport { viewingNote } from '../states/viewingNote';\nvar Mode;\n\n(function (Mode) {\n  Mode[Mode[\"IN\"] = 0] = \"IN\";\n  Mode[Mode[\"OUT\"] = 1] = \"OUT\";\n})(Mode || (Mode = {}));\n\nexport const Writer = () => {\n  // states\n  const {\n    0: src,\n    1: setSrc\n  } = useState(isWriteMode() ? getCache('writing') || '' : viewingNote.text);\n  const {\n    0: mode,\n    1: setMode\n  } = useState(Mode.IN); // reference to child components\n\n  const inputElement = useRef(null);\n  const outputElement = useRef(null);\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 28,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    style: buttons,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 7\n    }\n  }, __jsx(SaveButton, {\n    src: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 30,\n      columnNumber: 9\n    }\n  }), __jsx(BackButton, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 9\n    }\n  })), __jsx(\"textarea\", {\n    style: leftPane,\n    autoFocus: true,\n    placeholder: \"# Write Markdown here\",\n    onChange: e => {\n      setSrc(e.target.value);\n      cacheData('writing', src);\n    },\n    onMouseEnter: () => setMode(Mode.IN),\n    onTouchStart: () => setMode(Mode.IN),\n    onScroll: e => {\n      if (mode == Mode.IN) {\n        outputElement.current.scrollTop = e.currentTarget.scrollTop / (e.currentTarget.scrollHeight - windowHeight) * (outputElement.current.scrollHeight - windowHeight);\n      }\n    },\n    onKeyDown: e => {\n      if (e.ctrlKey && e.key == 'Enter' || e.shiftKey && e.key == 's') saveNote(src);\n    },\n    ref: inputElement,\n    value: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 33,\n      columnNumber: 7\n    }\n  }), __jsx(\"div\", {\n    style: rightPane,\n    onMouseEnter: () => setMode(Mode.OUT),\n    onTouchStart: () => setMode(Mode.OUT),\n    onScroll: e => {\n      if (mode == Mode.OUT) {\n        inputElement.current.scrollTop = e.currentTarget.scrollTop / (e.currentTarget.scrollHeight - windowHeight) * (inputElement.current.scrollHeight - windowHeight);\n      }\n    },\n    ref: outputElement,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }\n  }, __jsx(ReactMarkdown, {\n    source: src,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 9\n    }\n  })));\n};","map":{"version":3,"sources":["/home/teraoka/app/note/components/writer.tsx"],"names":["useState","useRef","ReactMarkdown","cacheData","getCache","buttons","leftPane","rightPane","windowHeight","BackButton","SaveButton","saveNote","isWriteMode","viewingNote","Mode","Writer","src","setSrc","text","mode","setMode","IN","inputElement","outputElement","e","target","value","current","scrollTop","currentTarget","scrollHeight","ctrlKey","key","shiftKey","OUT"],"mappings":"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","sourcesContent":["import { useState, useRef } from 'react'\nimport ReactMarkdown from 'react-markdown'\nimport { cacheData, getCache } from '../cache/cache'\nimport { buttons, leftPane, rightPane } from '../styles/styles'\nimport { windowHeight } from '../states/windowSize'\nimport { BackButton } from './backButton'\nimport { SaveButton, saveNote } from './saveButton'\nimport { isWriteMode } from '../states/appMode'\nimport { viewingNote } from '../states/viewingNote'\n\nenum Mode {\n  IN,\n  OUT,\n}\n\nexport const Writer = () => {\n  // states\n  const [src, setSrc] = useState(\n    isWriteMode() ? getCache('writing') || '' : viewingNote.text\n  )\n  const [mode, setMode] = useState(Mode.IN)\n\n  // reference to child components\n  const inputElement = useRef(null)\n  const outputElement = useRef(null)\n\n  return (\n    <div>\n      <div style={buttons}>\n        <SaveButton src={src}></SaveButton>\n        <BackButton></BackButton>\n      </div>\n      <textarea\n        style={leftPane}\n        autoFocus\n        placeholder=\"# Write Markdown here\"\n        onChange={(e) => {\n          setSrc(e.target.value)\n          cacheData('writing', src)\n        }}\n        onMouseEnter={() => setMode(Mode.IN)}\n        onTouchStart={() => setMode(Mode.IN)}\n        onScroll={(e) => {\n          if (mode == Mode.IN) {\n            outputElement.current.scrollTop =\n              (e.currentTarget.scrollTop /\n                (e.currentTarget.scrollHeight - windowHeight)) *\n              (outputElement.current.scrollHeight - windowHeight)\n          }\n        }}\n        onKeyDown={(e) => {\n          if ((e.ctrlKey && e.key == 'Enter') || (e.shiftKey && e.key == 's'))\n            saveNote(src)\n        }}\n        ref={inputElement}\n        value={src}\n      ></textarea>\n      <div\n        style={rightPane}\n        onMouseEnter={() => setMode(Mode.OUT)}\n        onTouchStart={() => setMode(Mode.OUT)}\n        onScroll={(e) => {\n          if (mode == Mode.OUT) {\n            inputElement.current.scrollTop =\n              (e.currentTarget.scrollTop /\n                (e.currentTarget.scrollHeight - windowHeight)) *\n              (inputElement.current.scrollHeight - windowHeight)\n          }\n        }}\n        ref={outputElement}\n      >\n        <ReactMarkdown source={src}></ReactMarkdown>\n      </div>\n    </div>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}