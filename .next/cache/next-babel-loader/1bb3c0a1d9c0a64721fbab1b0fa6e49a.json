{"ast":null,"code":"import { MongoClient } from 'mongodb';\nconst URL = 'mongodb://localhost:27017';\nconst NAME = 'mongodb';\nexport async function insertDocument(collectionName, document) {\n  await execute(async function () {\n    await this.collection(collectionName).insertOne(document);\n  });\n}\nexport async function findDocuments(collectionName, filter) {\n  let client;\n\n  try {\n    client = await MongoClient.connect(URL, {\n      useNewUrlParser: true\n    });\n    const db = client.db(NAME);\n    return await db.collection(collectionName).find({}).toArray();\n  } catch (error) {\n    console.error(error);\n  } finally {\n    client.close();\n  }\n}\n/**\n * @private\n */\n\nasync function execute(action) {\n  let client;\n\n  try {\n    client = await MongoClient.connect(URL, {\n      useNewUrlParser: true\n    });\n    const db = client.db(NAME);\n    return await action.call(db);\n  } catch (error) {\n    console.error(error);\n  } finally {\n    client.close();\n  }\n}","map":{"version":3,"sources":["/home/teraoka/app/note/logic/mongoAPI.ts"],"names":["MongoClient","URL","NAME","insertDocument","collectionName","document","execute","collection","insertOne","findDocuments","filter","client","connect","useNewUrlParser","db","find","toArray","error","console","close","action","call"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AAEA,MAAMC,GAAG,GAAG,2BAAZ;AACA,MAAMC,IAAI,GAAG,SAAb;AAEA,OAAO,eAAeC,cAAf,CACLC,cADK,EAELC,QAFK,EAGU;AACf,QAAMC,OAAO,CAAC,kBAAkB;AAC9B,UAAM,KAAKC,UAAL,CAAgBH,cAAhB,EAAgCI,SAAhC,CAA0CH,QAA1C,CAAN;AACD,GAFY,CAAb;AAGD;AAED,OAAO,eAAeI,aAAf,CACLL,cADK,EAELM,MAFK,EAGW;AAChB,MAAIC,MAAJ;;AACA,MAAI;AACFA,IAAAA,MAAM,GAAG,MAAMX,WAAW,CAACY,OAAZ,CAAoBX,GAApB,EAAyB;AAAEY,MAAAA,eAAe,EAAE;AAAnB,KAAzB,CAAf;AACA,UAAMC,EAAE,GAAGH,MAAM,CAACG,EAAP,CAAUZ,IAAV,CAAX;AACA,WAAO,MAAMY,EAAE,CAACP,UAAH,CAAcH,cAAd,EAA8BW,IAA9B,CAAmC,EAAnC,EAAuCC,OAAvC,EAAb;AACD,GAJD,CAIE,OAAOC,KAAP,EAAc;AACdC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACD,GAND,SAMU;AACRN,IAAAA,MAAM,CAACQ,KAAP;AACD;AACF;AAED;;;;AAGA,eAAeb,OAAf,CAAuBc,MAAvB,EAAyC;AACvC,MAAIT,MAAJ;;AACA,MAAI;AACFA,IAAAA,MAAM,GAAG,MAAMX,WAAW,CAACY,OAAZ,CAAoBX,GAApB,EAAyB;AAAEY,MAAAA,eAAe,EAAE;AAAnB,KAAzB,CAAf;AACA,UAAMC,EAAE,GAAGH,MAAM,CAACG,EAAP,CAAUZ,IAAV,CAAX;AACA,WAAO,MAAMkB,MAAM,CAACC,IAAP,CAAYP,EAAZ,CAAb;AACD,GAJD,CAIE,OAAOG,KAAP,EAAc;AACdC,IAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACD,GAND,SAMU;AACRN,IAAAA,MAAM,CAACQ,KAAP;AACD;AACF","sourcesContent":["import { MongoClient } from 'mongodb'\n\nconst URL = 'mongodb://localhost:27017'\nconst NAME = 'mongodb'\n\nexport async function insertDocument(\n  collectionName: string,\n  document: object\n): Promise<void> {\n  await execute(async function () {\n    await this.collection(collectionName).insertOne(document)\n  })\n}\n\nexport async function findDocuments(\n  collectionName: string,\n  filter: object\n): Promise<any[]> {\n  let client: MongoClient\n  try {\n    client = await MongoClient.connect(URL, { useNewUrlParser: true })\n    const db = client.db(NAME)\n    return await db.collection(collectionName).find({}).toArray()\n  } catch (error) {\n    console.error(error)\n  } finally {\n    client.close()\n  }\n}\n\n/**\n * @private\n */\nasync function execute(action: Function) {\n  let client: MongoClient\n  try {\n    client = await MongoClient.connect(URL, { useNewUrlParser: true })\n    const db = client.db(NAME)\n    return await action.call(db)\n  } catch (error) {\n    console.error(error)\n  } finally {\n    client.close()\n  }\n}\n"]},"metadata":{},"sourceType":"module"}